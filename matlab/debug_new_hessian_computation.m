XoptR = [...
2.0458676631e-01	9.2122773179e-01	-3.3088324411e-01;	
6.7582970860e-01	-3.7747036058e-01	-6.3306423991e-01;	
-7.0809495127e-01	-9.4104160741e-02	-6.9981850998e-01;	
1.0777048840e-01	9.7772698317e-01	-1.8009849589e-01;	
-4.8478807940e-01	-1.0647394522e-01	-8.6812661350e-01;	
-8.6796661221e-01	1.8086803305e-01	4.6251563727e-01;	
-3.6000244960e-01	9.2122773632e-01	1.4743708528e-01;	
-9.1886354460e-01	-3.7747035084e-01	1.1491701632e-01;	
1.6151787112e-01	-9.4104155414e-02	9.8237283413e-01;	
-1.9304740594e-01	9.7772698071e-01	8.2356846964e-02;	
-1.1807025714e-01	-1.0647395932e-01	9.8728046186e-01;	
9.7405960466e-01	1.8086803800e-01	1.3599499767e-01;	
3.7790944749e-01	9.2122773392e-01	9.2325033188e-02;	
8.1092272856e-01	-3.7747035440e-01	4.4712465808e-01;
4.4675359854e-01	-9.4104164669e-02	-8.8969412069e-01];

XoptT = [ ...
7.4278778025e+00	6.2215996036e+00	3.6013149198e+00	4.1219567517e+00	4.0422112790e+00;
1.1032050684e+01	1.2912549336e+01	5.0481997600e+00	-1.9307078254e+00	2.3905388088e+00;	
9.8858588795e+00	5.8718472026e-01	-3.5716724829e+00	3.1993497384e+00	1.1404862748e+01];


Xopt.R = cat_zero_rows_3d_array(matUnstack(XoptR, 3));
Xopt.T = cat_zero_row(XoptT);

%% tnet
testdata = testNetwork_params(3, 5, 'banded', 3); %4 would be the default

T_gf = G2T(testdata.gi);
Tijs = G2T(testdata.gijtruth);

d = size(Tijs, 1);
p = d+1;
N = size(T_gf, 2);


problem_struct = [];
problem_struct.Tijs = Tijs;
problem_struct.edges = testdata.E;

problem_struct.sz = [d+1, d, N];

%% makeHmat()

Hmat = make_H_mat(Xopt, problem_struct);

[eigvecs, eigvals] = eig(0.5*(Hmat + Hmat'));

disp("diag(diag(eigvals))")
disp(diag(eigvals))

disp("eigvecs")
disp(eigvecs)

% disp("Hmat")
% disp(Hmat)

%%%
% XoptR = [-5.3157859714e-01	6.0110786651e-01	5.9673572700e-01;	
% 4.4928953476e-01	7.9734796044e-01	-4.0295799277e-01;	
% -7.1802723417e-01	5.3903272658e-02	-6.9392458393e-01;
% 6.5445250401e-01	3.2234059263e-01	6.8395062858e-01;	
% 2.9238994046e-02	8.9310730256e-01	-4.4889244519e-01;	
% -7.5553755778e-01	3.1377681314e-01	5.7507139584e-01;	
% 7.3907060016e-01	6.1471287172e-01	-2.7550450688e-01;	
% -6.0679119891e-01	7.8512738304e-01	1.2401384329e-01;	
% 2.9253903824e-01	7.5518724451e-02	9.5326692661e-01;	
% -1.4291408129e-01	2.8364958641e-01	-9.4821858108e-01;	
% -2.8591573073e-01	9.0537433130e-01	3.1392597080e-01;	
% 9.4753773555e-01	3.1597505021e-01	-4.8290862013e-02;	
% -7.9744225820e-01	5.9569919019e-01	-9.6064143428e-02;	
% 5.6233114936e-01	7.9142145782e-01	2.3965757775e-01;	
% 2.1879104942e-01	1.3709321981e-01	-9.6609312480e-01];
% 
% 
% XoptT = [4.7821429784e+00	4.6486082076e+00	5.2460408853e+00	5.6674076616e+00	5.0707606236e+00;
% 6.0866713075e+00	6.1437377151e+00	5.7877134942e+00	5.6836495024e+00	5.7508587448e+00;	
% 4.7174226750e+00	3.9352705724e+00	3.7048040069e+00	4.3133692218e+00	4.8347171270e+00];
